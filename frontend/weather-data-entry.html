<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞ PM2.5</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; position: relative; }
        input { margin: 5px; padding: 8px; }
        button { padding: 10px; color: white; border: none; cursor: pointer; }
        button:hover { opacity: 0.8; }
        .btn-save { background-color: #28a745; }
        .btn-clear { background-color: #534546; }
        .btn-logout {
            background-color: #ff0000;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        canvas { max-width: 600px; margin-top: 20px; }
    </style>
</head>
<body>

    <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞ PM2.5</h2>
    
    üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <input type="date" id="date">
    üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: <input type="text" id="province" placeholder=>
    üå°Ô∏è ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C): <input type="number" id="temperature" placeholder=>
    üå´Ô∏è PM2.5 (¬µg/m¬≥): <input type="number" id="pm25" placeholder=>
    
    <br><br>
    <button class="btn-save" onclick="addData()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    <button class="btn-logout" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>

    <canvas id="myChart"></canvas>

    <script>
       
        let storedData = localStorage.getItem("weatherData");
        let data = storedData ? JSON.parse(storedData) : {
            labels: [],
            datasets: [
    { label: "PM2.5 (¬µg/m¬≥)", data: [], backgroundColor: "rgba(173, 216, 230, 0.7)" }, 
    { label: "‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)", data: [], backgroundColor: "rgba(255, 160, 122, 0.7)" }  
    ]

        };

        let ctx = document.getElementById("myChart").getContext("2d");
        let myChart = new Chart(ctx, {
            type: "bar",
            data: data,
            options: { 
                responsive: true,
                scales: { 
                    x: { title: { display: true, text: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà" } },
                    y: { title: { display: true, text: "‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ / PM2.5" } } 
                }
            }
        });

        function addData() {
            let date = document.getElementById("date").value;
            let province = document.getElementById("province").value;
            let temperature = document.getElementById("temperature").value;
            let pm25 = document.getElementById("pm25").value;

            if (date && province && temperature && pm25) {
                data.labels.push(`${date} (${province})`);
                data.datasets[0].data.push(parseFloat(pm25));
                data.datasets[1].data.push(parseFloat(temperature));

                
                localStorage.setItem("weatherData", JSON.stringify(data));

                myChart.update();
            } else {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö!");
            }
        }

        function clearData() {
            localStorage.removeItem("weatherData");
            data.labels = [];
            data.datasets[0].data = [];
            data.datasets[1].data = [];
            myChart.update();
            alert("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
        }

        function logout() {
            localStorage.clear(); 
            alert("‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
            window.location.href = "login.html";
        }
    </script>

</body>
</html>
