<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏®</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
    body {
        background-image: url('https://files.oaiusercontent.com/file-QU2iDzwb3bmKBSpSc62o1e?se=2025-03-01T20%3A15%3A52Z&sp=r&sv=2024-08-04&sr=b&rscc=max-age%3D604800%2C%20immutable%2C%20private&rscd=attachment%3B%20filename%3Ddbb5fc66-22c6-48ac-abfd-7258865d679e.webp&sig=FUhis2xDEUgXZ7N7prM1Xk3ihWoTnAdp9FNM4Bywsbg%3D'); 
        background-size: cover; 
        background-position: center center;
        background-attachment: fixed; 
        color: #000000; 
        min-height: 100vh; 
    }
    #weather-trend-container {
        margin-top: 20px;
    }
    canvas {
        max-width: 100%;
        height: auto;
    }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="menu-icon" id="menu-icon">
        </div>
        <div class="menu-links">
            <a href="/" id="home-link">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
            <a href="/weather-forecast" id="weather-forecast-link">‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏®</a>
            <a href="/weather-10days" id="weather-10days-link">‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ 5 ‡∏ß‡∏±‡∏ô</a>
            <a href="/weather-data-entry" id="weather-data-entry-link">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®</a>
        </div>
    </div>

    <div class="container">
        <div class="search-container">
            <input type="text" id="search-location" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á">
            <button id="search-btn">üîç</button>
        </div>
        <div id="status-message" style="display: none; text-align: center; margin-bottom: 20px;">
            <strong>‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£? ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</strong>
        </div>
        <div id="weather-info" class="weather-info-container">
            <div class="weather-card">
                <h3 id="location-name">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h3>
                <p>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥: <span id="temperature">-</span></p>
                <p>‡πÄ‡∏ß‡∏•‡∏≤: <span id="current-time">-</span></p>
            </div>
        </div>

        <div id="weather-trend-container">
            <h3>‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏®</h3>
            <canvas id="weather-trend-chart" width="400" height="200"></canvas>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../js/weather.js"></script>

    <script>
        document.getElementById("search-btn").addEventListener("click", async function() {
            const location = document.getElementById('search-location').value;
            if (!location) return;

            const apiKey = 'e04255ffd96d458f342df800f6c8d7ea'; 
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${location}&units=metric&appid=${apiKey}`;
            
            try {
                const response = await fetch(url);
                const data = await response.json();

                if (data.cod !== 200) {
                    alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà");
                    return;
                }

                // ‡∏à‡∏±‡∏î‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                const weatherData = {
                    location: data.name,
                    temperature: data.main.temp + "¬∞C",
                    condition: data.weather[0].description,
                    timestamp: new Date().toLocaleString()
                };

                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô LocalStorage
                let weatherLogs = JSON.parse(localStorage.getItem("weatherLogs")) || [];
                weatherLogs.push(weatherData);
                localStorage.setItem("weatherLogs", JSON.stringify(weatherLogs));

                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                document.getElementById('location-name').textContent = data.name;
                document.getElementById('temperature').textContent = data.main.temp + "¬∞C";
                document.getElementById('current-time').textContent = new Date().toLocaleString();

                // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏≠‡∏Å
                document.getElementById('search-location').value = "";
            } catch (error) {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Å‡∏≤‡∏®");
            }
        });
    </script>
</body>
</html>
